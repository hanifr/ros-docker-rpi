# Gazebo-ros-docker on Raspberry Pi 4B for Ubuntu 24.04.2 Desktop LTS

# Initial Setup on Raspberry PI
```bash
sudo apt-get update && apt-get upgrade
```

# Clone the git repository
```bash
git clone https://github.com/hanifr/ros-docker-rpi.git
```

### Directory Structure
```
gazebo-ros-pi/
â”œâ”€â”€ docker-compose.pi.yml     âœ… ROS 2 Humble optimized for Pi 4B
â”œâ”€â”€ Dockerfile.arm64          âœ… ARM64 ROS 2 base with Gazebo
â”œâ”€â”€ Dockerfile.web            âœ… Simplified Flask web interface  
â”œâ”€â”€ Dockerfile.monitor        âœ… Pi resource monitoring
â””â”€â”€ requirements.txt          âœ… Python dependencies
â”œâ”€â”€ models/                   # Custom Gazebo models
â”‚   â”œâ”€â”€ my_robot/
â”‚   â””â”€â”€ sensors/
â”œâ”€â”€ monitor/                   # Monitoring UI
â”‚   â”œâ”€â”€ monitor.py
â”‚   â””â”€â”€ requirements.txt
â”œâ”€â”€ worlds/                            # Gazebo world files
â”‚   â”œâ”€â”€ simple_world.world
â”‚   â””â”€â”€ obstacle_course.world
â”œâ”€â”€ ros2_ws/                           # ROS workspace
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ my_robot_description/      # Robot URDF models
â”‚   â”‚   â”‚   â”œâ”€â”€ urdf/
â”‚   â”‚   â”‚   â”œâ”€â”€ meshes/
â”‚   â”‚   â”‚   â””â”€â”€ config/
â”‚   â”‚   â””â”€â”€ my_robot_gazebo/           # Simulation configuration
â”‚   â”‚   â”‚   â”œâ”€â”€ launch/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ headless_simulation.launch  # âœ… Launch file
â”‚   â”‚   â”‚   â”œâ”€â”€ worlds/
â”‚   â”‚   â”‚   â””â”€â”€ config/
â”‚   â”œâ”€â”€ build/                         # Generated by ros2_make
â”‚   â””â”€â”€ install/                       # Generated by ros2_make
â”‚   â””â”€â”€ log/                           # Generated by ros2_make
â”œâ”€â”€ scripts/                           # Helper scripts
â”‚   â”œâ”€â”€ init.sh                        # Pi environment setup
â”‚   â”œâ”€â”€ run_headless_sim.sh            # Headless simulation 
â”‚   â”œâ”€â”€ test_docker_setup.sh           # Comprehensive Docker testing 
â”‚   â”œâ”€â”€ quick_start.sh                 # Quick start guide
launcher
â”‚   â”œâ”€â”€ start_web_interface.sh         # Web UI launcher
â”‚   â”œâ”€â”€ teleop.sh                      # Robot control
â”‚   â”œâ”€â”€ monitor_pi_resources.sh        # Created by pi_setup.sh
â”‚   â””â”€â”€ ...
â””â”€â”€ web_interface/                     # ğŸ”„ Created by start_web_interface.sh
    â”œâ”€â”€ app.py                         # Flask web application
    â”œâ”€â”€ templates/
    â”‚   â””â”€â”€ index.html                 # Web interface HTML
    â””â”€â”€ static/                        # CSS/JS files (if needed)
```


# Steps
# Check the file structure
```bash
tree -L 3
```
# Build ROS workspace
```bash
sudo apt install colcon -y
cd ros2_ws
colcon build --symlink-install
```

# Build containers
```bash
cd ~/gazebo-ros-pi
docker-compose -f docker-compose.pi.yml build gazebo-sim

# Start services
docker-compose -f docker-compose.pi.yml up -d

# Start with monitoring profile
docker-compose -f docker-compose.pi.yml --profile monitoring up -d

# Check status
docker-compose -f docker-compose.pi.yml ps

# Prune all containers and images
docker system prune -a -f
```
ROS 2 Simulation: Port 9090 (ROSBridge)
Web Interface: http://your-pi-ip:5000
Resource Monitor: http://your-pi-ip:8000 (if using --profile monitoring)
Gazebo: Headless mode, accessible via web interface

# Troubleshooting: Clean the failed build
```bash
# Clean everything
docker-compose -f docker-compose.pi.yml down
docker system prune -a -f  # This removes everything

# Rebuild the gazebo-sim service (will take 20-30 minutes on Pi)
docker-compose -f docker-compose.pi.yml build --no-cache gazebo-sim

# If successful, you should see messages like:
# âœ… ROS 2 sourced successfully
# âœ… ROS 2 command working  
# âœ… ROS 2 packages available
```

# any created scripts, ensure to change the privilege
```bash
sudo chmod +x *.sh *.py
```

# check OS details
```bash
cat /etc/os-release
```

PRETTY_NAME="Ubuntu 24.04.2 LTS"
NAME="Ubuntu"
VERSION_ID="24.04"
VERSION="24.04.2 LTS (Noble Numbat)"
VERSION_CODENAME=noble
ID=ubuntu
ID_LIKE=debian
HOME_URL="https://www.ubuntu.com/"
SUPPORT_URL="https://help.ubuntu.com/"
BUG_REPORT_URL="https://bugs.launchpad.net/ubuntu/"
PRIVACY_POLICY_URL="https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"
UBUNTU_CODENAME=noble
LOGO=ubuntu-logo

# Controller Tuning Guide
## Make algorithms DRAMATICALLY different:
proportional
        kp_linear: 2.0,        // Very aggressive
        max_linear: 1.0
pid
        kp_linear: 0.3,        // Very conservative
        ki_linear: 0.5,        // High integral gain
        max_linear: 0.3

pure_pursuit
        lookahead_distance: 1.5, // Much longer lookahead
        max_linear: 0.8

```bash
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Material Handling UI         â”‚ â†  Web dashboard
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         ROS 2 Bridge                â”‚ â† WebSocket connection
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Navigation/Control Logic         â”‚ â† Algorithms
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Virtual Robot (Python)            â”‚ â† Lightweight simulation
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         ROS 2 Core                  â”‚ â† Standard ROS messaging
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# vs Gazebo Stack:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Material Handling UI         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         ROS 2 Bridge                â”‚  
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    Navigation/Control Logic         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Gazebo Server              â”‚ â† Heavy 3D simulation
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        Physics Engine (ODE)         â”‚ â† Complex physics
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       Graphics Engine (OGRE)        â”‚ â† 3D rendering
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         ROS 2 Core                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


# Extra

# Run Pi setup (installs Docker, ROS, etc.)
```bash
./scripts/init.sh
# After completion, test everything:
./scripts/test_docker_setup.sh

# Get quick start guide:
./scripts/quick_start.sh
```
# Start web interface (creates web_interface/ directory)
```bash
./scripts/start_web_interface.sh
```
# Gazebo-ros-docker on Raspberry Pi 4B for Ubuntu 24.04.2 Desktop LTS

# Initial Setup on Raspberry PI
```bash
sudo apt-get update && apt-get upgrade
```

# Clone the git repository
```bash
git clone https://github.com/hanifr/ros-docker-rpi.git
```

### Directory Structure
```
gazebo-ros-pi/
├── docker-compose.pi.yml     ✅ ROS 2 Humble optimized for Pi 4B
├── Dockerfile.arm64          ✅ ARM64 ROS 2 base with Gazebo
├── Dockerfile.web            ✅ Simplified Flask web interface  
├── Dockerfile.monitor        ✅ Pi resource monitoring
└── requirements.txt          ✅ Python dependencies
├── models/                   # Custom Gazebo models
│   ├── my_robot/
│   └── sensors/
├── monitor/                   # Monitoring UI
│   ├── monitor.py
│   └── requirements.txt
├── worlds/                            # Gazebo world files
│   ├── simple_world.world
│   └── obstacle_course.world
├── ros2_ws/                           # ROS workspace
│   ├── src/
│   │   ├── my_robot_description/      # Robot URDF models
│   │   │   ├── urdf/
│   │   │   ├── meshes/
│   │   │   └── config/
│   │   └── my_robot_gazebo/           # Simulation configuration
│   │   │   ├── launch/
│   │   │   │   └── headless_simulation.launch  # ✅ Launch file
│   │   │   ├── worlds/
│   │   │   └── config/
│   ├── build/                         # Generated by ros2_make
│   └── install/                       # Generated by ros2_make
│   └── log/                           # Generated by ros2_make
├── scripts/                           # Helper scripts
│   ├── init.sh                        # Pi environment setup
│   ├── run_headless_sim.sh            # Headless simulation 
│   ├── test_docker_setup.sh           # Comprehensive Docker testing 
│   ├── quick_start.sh                 # Quick start guide
launcher
│   ├── start_web_interface.sh         # Web UI launcher
│   ├── teleop.sh                      # Robot control
│   ├── monitor_pi_resources.sh        # Created by pi_setup.sh
│   └── ...
└── web_interface/                     # 🔄 Created by start_web_interface.sh
    ├── app.py                         # Flask web application
    ├── templates/
    │   └── index.html                 # Web interface HTML
    └── static/                        # CSS/JS files (if needed)
```


# Steps
# Check the file structure
```bash
tree -L 3
```
# Build ROS workspace
```bash
sudo apt install colcon -y
cd ros2_ws
colcon build --symlink-install
```

# Build containers
```bash
cd ~/gazebo-ros-pi
docker-compose -f docker-compose.pi.yml build gazebo-sim

# Start services
docker-compose -f docker-compose.pi.yml up -d

# Start with monitoring profile
docker-compose -f docker-compose.pi.yml --profile monitoring up -d

# Check status
docker-compose -f docker-compose.pi.yml ps

# Prune all containers and images
docker system prune -a -f
```
ROS 2 Simulation: Port 9090 (ROSBridge)
Web Interface: http://your-pi-ip:5000
Resource Monitor: http://your-pi-ip:8000 (if using --profile monitoring)
Gazebo: Headless mode, accessible via web interface

# Troubleshooting: Clean the failed build
```bash
# Clean everything
docker-compose -f docker-compose.pi.yml down
docker system prune -a -f  # This removes everything

# Rebuild the gazebo-sim service (will take 20-30 minutes on Pi)
docker-compose -f docker-compose.pi.yml build --no-cache gazebo-sim

# If successful, you should see messages like:
# ✅ ROS 2 sourced successfully
# ✅ ROS 2 command working  
# ✅ ROS 2 packages available
```

# any created scripts, ensure to change the privilege
```bash
sudo chmod +x *.sh *.py
```

# check OS details
```bash
cat /etc/os-release
```

PRETTY_NAME="Ubuntu 24.04.2 LTS"
NAME="Ubuntu"
VERSION_ID="24.04"
VERSION="24.04.2 LTS (Noble Numbat)"
VERSION_CODENAME=noble
ID=ubuntu
ID_LIKE=debian
HOME_URL="https://www.ubuntu.com/"
SUPPORT_URL="https://help.ubuntu.com/"
BUG_REPORT_URL="https://bugs.launchpad.net/ubuntu/"
PRIVACY_POLICY_URL="https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"
UBUNTU_CODENAME=noble
LOGO=ubuntu-logo

# Controller Tuning Guide
## Make algorithms DRAMATICALLY different:
proportional
        kp_linear: 2.0,        // Very aggressive
        max_linear: 1.0
pid
        kp_linear: 0.3,        // Very conservative
        ki_linear: 0.5,        // High integral gain
        max_linear: 0.3

pure_pursuit
        lookahead_distance: 1.5, // Much longer lookahead
        max_linear: 0.8

```bash
┌─────────────────────────────────────┐
│        Material Handling UI         │ ←  Web dashboard
├─────────────────────────────────────┤
│         ROS 2 Bridge                │ ← WebSocket connection
├─────────────────────────────────────┤
│    Navigation/Control Logic         │ ← Algorithms
├─────────────────────────────────────┤
│   Virtual Robot (Python)            │ ← Lightweight simulation
├─────────────────────────────────────┤
│         ROS 2 Core                  │ ← Standard ROS messaging
└─────────────────────────────────────┘

# vs Gazebo Stack:
┌─────────────────────────────────────┐
│        Material Handling UI         │
├─────────────────────────────────────┤
│         ROS 2 Bridge                │  
├─────────────────────────────────────┤
│    Navigation/Control Logic         │
├─────────────────────────────────────┤
│          Gazebo Server              │ ← Heavy 3D simulation
├─────────────────────────────────────┤
│        Physics Engine (ODE)         │ ← Complex physics
├─────────────────────────────────────┤
│       Graphics Engine (OGRE)        │ ← 3D rendering
├─────────────────────────────────────┤
│         ROS 2 Core                  │
└─────────────────────────────────────┘
```


# Extra

# Run Pi setup (installs Docker, ROS, etc.)
```bash
./scripts/init.sh
# After completion, test everything:
./scripts/test_docker_setup.sh

# Get quick start guide:
./scripts/quick_start.sh
```
# Start web interface (creates web_interface/ directory)
```bash
./scripts/start_web_interface.sh
```